"use strict";(self["webpackChunkecodeco_user_client"]=self["webpackChunkecodeco_user_client"]||[]).push([[436],{22436:(e,t,u)=>{u.r(t),u.d(t,{default:()=>R});u(52675),u(89463),u(44114),u(62010),u(9868);var r=u(56768),a=u(95187),o=function(e){return(0,r.Qi)("data-v-2ffd21b7"),e=e(),(0,r.jt)(),e},c={class:"product-detail"},n={key:0,class:"container"},l={class:"product-content"},i={class:"product-image"},d={class:"product-badges"},s={key:0,class:"eco-badge"},p={key:1,class:"recyclable-badge"},v={key:2,class:"custom-badge"},f={class:"product-info"},b={class:"product-name"},k={class:"product-meta"},g={class:"product-price"},m={class:"product-actions"},_=o((function(){return(0,r.Lk)("i",{class:"el-icon-shopping-cart-2"},null,-1)})),h={class:"product-tabs"},y={class:"product-description"},F=o((function(){return(0,r.Lk)("h3",null,"产品描述",-1)})),C=o((function(){return(0,r.Lk)("h3",null,"规格参数",-1)})),L={class:"related-products"},w=o((function(){return(0,r.Lk)("h2",{class:"section-title"},"相关产品推荐",-1)})),W={key:1,class:"loading-container"};function E(e,t,u,o,E,x){var A=(0,r.g2)("el-breadcrumb-item"),X=(0,r.g2)("el-breadcrumb"),P=(0,r.g2)("el-image"),I=(0,r.g2)("el-input-number"),V=(0,r.g2)("el-button"),T=(0,r.g2)("el-table-column"),q=(0,r.g2)("el-table"),K=(0,r.g2)("el-tab-pane"),Q=(0,r.g2)("el-tabs"),U=(0,r.g2)("product-card"),j=(0,r.g2)("el-col"),D=(0,r.g2)("el-row"),R=(0,r.g2)("el-skeleton"),N=(0,r.g2)("el-result");return(0,r.uX)(),(0,r.CE)("div",c,[o.product?((0,r.uX)(),(0,r.CE)("div",n,[(0,r.bF)(X,{separator:"/"},{default:(0,r.k6)((function(){return[(0,r.bF)(A,{to:{path:"/"}},{default:(0,r.k6)((function(){return[(0,r.eW)("首页")]})),_:1}),(0,r.bF)(A,{to:{path:"/products"}},{default:(0,r.k6)((function(){return[(0,r.eW)("全部产品")]})),_:1}),(0,r.bF)(A,{to:{path:"/products?category=".concat(o.product.category)}},{default:(0,r.k6)((function(){return[(0,r.eW)((0,a.v_)(o.product.category),1)]})),_:1},8,["to"]),(0,r.bF)(A,null,{default:(0,r.k6)((function(){return[(0,r.eW)((0,a.v_)(o.product.name),1)]})),_:1})]})),_:1}),(0,r.Lk)("div",l,[(0,r.Lk)("div",i,[(0,r.bF)(P,{src:o.fullImageUrl,alt:o.product.name,fit:"cover"},null,8,["src","alt"]),(0,r.Lk)("div",d,[o.product.eco_certification?((0,r.uX)(),(0,r.CE)("span",s,(0,a.v_)(o.product.eco_certification),1)):(0,r.Q3)("",!0),o.product.is_recyclable?((0,r.uX)(),(0,r.CE)("span",p,"可回收")):(0,r.Q3)("",!0),o.product.is_custom?((0,r.uX)(),(0,r.CE)("span",v,"可定制")):(0,r.Q3)("",!0)])]),(0,r.Lk)("div",f,[(0,r.Lk)("h1",b,(0,a.v_)(o.product.name),1),(0,r.Lk)("div",k,[(0,r.Lk)("div",g,"¥"+(0,a.v_)(o.product.price.toFixed(2)),1),(0,r.Lk)("div",{class:(0,a.C4)(["product-stock",{"out-of-stock":o.product.stock<=0}])},(0,a.v_)(o.product.stock>0?"库存: ".concat(o.product.stock):"库存不足"),3)]),(0,r.Lk)("div",m,[(0,r.bF)(I,{modelValue:o.quantity,"onUpdate:modelValue":t[0]||(t[0]=function(e){return o.quantity=e}),min:1,max:o.product.stock,disabled:o.product.stock<=0},null,8,["modelValue","max","disabled"]),(0,r.bF)(V,{type:"primary",disabled:o.product.stock<=0,onClick:o.addToCart},{default:(0,r.k6)((function(){return[_,(0,r.eW)(" 加入购物车 ")]})),_:1},8,["disabled","onClick"]),(0,r.bF)(V,{type:"success",disabled:o.product.stock<=0,onClick:o.buyNow},{default:(0,r.k6)((function(){return[(0,r.eW)(" 立即购买 ")]})),_:1},8,["disabled","onClick"])])])]),(0,r.Lk)("div",h,[(0,r.bF)(Q,{modelValue:o.activeTab,"onUpdate:modelValue":t[1]||(t[1]=function(e){return o.activeTab=e})},{default:(0,r.k6)((function(){return[(0,r.bF)(K,{label:"产品详情",name:"details"},{default:(0,r.k6)((function(){return[(0,r.Lk)("div",y,[F,(0,r.Lk)("p",null,(0,a.v_)(o.product.description),1),C,(0,r.bF)(q,{data:o.specifications,stripe:"",style:{width:"100%"}},{default:(0,r.k6)((function(){return[(0,r.bF)(T,{prop:"name",label:"参数名",width:"180"}),(0,r.bF)(T,{prop:"value",label:"参数值"})]})),_:1},8,["data"])])]})),_:1})]})),_:1},8,["modelValue"])]),(0,r.Lk)("div",L,[w,(0,r.bF)(D,{gutter:20},{default:(0,r.k6)((function(){return[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.relatedProducts,(function(e){return(0,r.uX)(),(0,r.Wv)(j,{xs:24,sm:12,md:8,lg:6,key:e.id},{default:(0,r.k6)((function(){return[(0,r.bF)(U,{product:e},null,8,["product"])]})),_:2},1024)})),128))]})),_:1})])])):o.loading?((0,r.uX)(),(0,r.CE)("div",W,[(0,r.bF)(R,{rows:10,animated:""})])):((0,r.uX)(),(0,r.Wv)(N,{key:2,icon:"error",title:"加载失败","sub-title":"请稍后再试或返回首页"},{extra:(0,r.k6)((function(){return[(0,r.bF)(V,{type:"primary",onClick:t[2]||(t[2]=function(t){return e.$router.push("/")})},{default:(0,r.k6)((function(){return[(0,r.eW)("返回首页")]})),_:1})]})),_:1}))])}var x=u(14048),A=u(74721),X=u(30388),P=(u(28706),u(2008),u(74423),u(64346),u(48598),u(34782),u(18111),u(22489),u(26099),u(21699),u(71798)),I=u(50973),V=u(60782),T=u(51219),q=u(73047),K=u(61981),Q=u(41154);const U={name:"ProductDetail",components:{ProductCard:q.A,EcoIcon:Q.A},setup:function(){var e=(0,I.lq)(),t=(0,I.rd)(),u=(0,V.Pj)(),a=(0,r.EW)((function(){return u.getters["products/currentProduct"]})),o=(0,r.EW)((function(){return u.getters["isLoading"]})),c=(0,P.KR)("details"),n=(0,P.KR)(1),l=(0,r.EW)((function(){var e,t,u,r,o,c=[];if(null!==(e=a.value)&&void 0!==e&&e.material&&c.push({name:"蔬菜瓜果类型",value:a.value.material}),void 0!==(null===(t=a.value)||void 0===t?void 0:t.eco_labels)&&null!==(null===(u=a.value)||void 0===u?void 0:u.eco_labels)&&a.value.eco_labels.length>0){var n=Array.isArray(a.value.eco_labels)?a.value.eco_labels.join("，"):a.value.eco_labels;c.push({name:"营养标签",value:n})}return void 0!==(null===(r=a.value)||void 0===r?void 0:r.carbon_footprint)&&null!==(null===(o=a.value)||void 0===o?void 0:o.carbon_footprint)&&c.push({name:"每件总量",value:"".concat(a.value.carbon_footprint," Kg")}),c.push({name:"产地",value:"中国大陆"}),c})),i=(0,P.KR)([]);(0,r.sV)((0,X.A)((0,x.A)().mark((function r(){var o,c,n,l;return(0,x.A)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(r.prev=0,o=e.params.id,console.log("产品详情页-路由参数:",e.params),o){r.next=8;break}return console.error("产品ID为空，无法获取产品详情"),T.nk.error("无效的产品ID"),t.push("/products"),r.abrupt("return");case 8:return r.next=10,u.dispatch("products/fetchProduct",o);case 10:if(r.sent,a.value){r.next=16;break}return console.error("产品获取失败，返回产品列表页"),T.nk.error("无法获取产品详情"),t.push("/products"),r.abrupt("return");case 16:console.log("产品详情页-获取到产品:",a.value),c=u.getters["products/allProducts"],a.value&&c&&c.length>0?(n=a.value.product_id||a.value.id,i.value=c.filter((function(e){return e.category===a.value.category&&(e.product_id||e.id)!==n})).slice(0,4),i.value.length<4&&(l=c.filter((function(e){return(e.product_id||e.id)!==n&&!i.value.includes(e)})).slice(0,4-i.value.length),i.value=[].concat((0,A.A)(i.value),(0,A.A)(l)))):console.log("没有找到足够的产品数据来推荐相关产品"),r.next=25;break;case 21:r.prev=21,r.t0=r["catch"](0),console.error("获取产品详情失败:",r.t0),T.nk.error("获取产品详情失败");case 25:case"end":return r.stop()}}),r,null,[[0,21]])}))));var d=function(){a.value.stock<=0?T.nk.warning("该产品已售罄"):(u.dispatch("cart/addToCart",{product:a.value,quantity:n.value}),T.nk.success("成功添加到购物车"))},s=function(){d(),t.push("/cart")},p=(0,r.EW)((function(){return a.value?(console.log("处理产品图片，产品数据:",a.value),a.value.image?a.value.image:a.value.image_url?(0,K.m)(a.value.image_url):a.value.images&&a.value.images.length>0?a.value.images[0]:(console.warn("产品没有图片"),"/img/default-product.png")):"/img/default-product.png"}));return{product:a,loading:o,activeTab:c,quantity:n,specifications:l,relatedProducts:i,addToCart:d,buyNow:s,fullImageUrl:p}}};var j=u(71241);const D=(0,j.A)(U,[["render",E],["__scopeId","data-v-2ffd21b7"]]),R=D}}]);
//# sourceMappingURL=436.dfbc0c69.js.map