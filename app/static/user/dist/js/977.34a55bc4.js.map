{"version":3,"file":"js/977.34a55bc4.js","mappings":"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","sources":["webpack://ecodeco-user-client/./src/views/Cart.vue","webpack://ecodeco-user-client/./src/views/Cart.vue?27b4"],"sourcesContent":["<template>\n  <div class=\"cart-page\">\n    <div class=\"container\">\n      <div class=\"page-header\">\n        <h1>我的购物车</h1>\n      </div>\n      \n      <div v-if=\"cartItems.length > 0\">\n        <el-table :data=\"cartItems\" style=\"width: 100%\" :header-cell-style=\"{ background: '#f5f7fa' }\">\n          <el-table-column label=\"商品信息\" min-width=\"400\">\n            <template #default=\"{ row }\">\n              <div class=\"product-info\">\n                <el-image \n                  :src=\"getFullImageUrl(row.image_url)\" \n                  :alt=\"row.name\" \n                  class=\"product-image\"\n                  @error=\"handleImageError(row)\">\n                  <template #error>\n                    <div class=\"image-error-slot\">\n                      <el-icon><PictureFilled /></el-icon>\n                    </div>\n                  </template>\n                </el-image>\n                <div class=\"product-details\">\n                  <h3>{{ row.name }}</h3>\n                  <div v-if=\"row.eco_certification || row.is_recyclable\" class=\"product-tags\">\n                    <el-tag v-if=\"row.eco_certification\" size=\"small\" type=\"success\">\n                      {{ row.eco_certification }}\n                    </el-tag>\n                    <el-tag v-if=\"row.is_recyclable\" size=\"small\" type=\"info\">可回收</el-tag>\n                  </div>\n                </div>\n              </div>\n            </template>\n          </el-table-column>\n          \n          <el-table-column label=\"单价\" align=\"center\" width=\"120\">\n            <template #default=\"{ row }\">\n              <span class=\"price\">¥{{ row.price.toFixed(2) }}</span>\n            </template>\n          </el-table-column>\n          \n          <el-table-column label=\"数量\" align=\"center\" width=\"150\">\n            <template #default=\"{ row }\">\n              <el-input-number \n                v-model=\"row.quantity\" \n                :min=\"1\" \n                :max=\"10\"\n                @change=\"handleQuantityChange(row)\"\n                size=\"small\">\n              </el-input-number>\n            </template>\n          </el-table-column>\n          \n          <el-table-column label=\"小计\" align=\"center\" width=\"120\">\n            <template #default=\"{ row }\">\n              <span class=\"subtotal\">¥{{ (row.price * row.quantity).toFixed(2) }}</span>\n            </template>\n          </el-table-column>\n          \n          <el-table-column label=\"操作\" align=\"center\" width=\"80\">\n            <template #default=\"{ row }\">\n              <el-button \n                type=\"text\" \n                @click=\"handleRemove(row)\" \n                style=\"color: #F56C6C\">\n                删除\n              </el-button>\n            </template>\n          </el-table-column>\n        </el-table>\n        \n        <div class=\"cart-actions\">\n          <div class=\"cart-summary\">\n            <div class=\"summary-row\">\n              <span>商品总价:</span>\n              <span class=\"summary-value\">¥{{ cartTotal.toFixed(2) }}</span>\n            </div>\n            <div class=\"summary-row\">\n              <span>优惠金额:</span>\n              <span class=\"summary-value\">¥0.00</span>\n            </div>\n            <div class=\"summary-row total\">\n              <span>应付金额:</span>\n              <span class=\"summary-value\">¥{{ cartTotal.toFixed(2) }}</span>\n            </div>\n          </div>\n          \n          <div class=\"action-buttons\">\n            <el-button @click=\"$router.push('/products')\">继续购物</el-button>\n            <el-button type=\"primary\" @click=\"handleCheckout\" :disabled=\"!isAuthenticated\">\n              结算 ({{ cartCount }} 件)\n            </el-button>\n          </div>\n        </div>\n      </div>\n      \n      <el-empty v-else description=\"您的购物车是空的\">\n        <el-button type=\"primary\" @click=\"$router.push('/products')\">去购物</el-button>\n      </el-empty>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { computed, onMounted } from 'vue'\nimport { useStore } from 'vuex'\nimport { useRouter } from 'vue-router'\nimport { ElMessageBox, ElMessage } from 'element-plus'\nimport { getFullImageUrl } from '../utils/index'\nimport { PictureFilled } from '@element-plus/icons-vue'\n\nexport default {\n  name: 'Cart',\n  components: {\n    PictureFilled\n  },\n  setup() {\n    const store = useStore()\n    const router = useRouter()\n    \n    const cartItems = computed(() => store.getters['cart/cartItems'])\n    const cartTotal = computed(() => store.getters['cart/cartTotal'])\n    const cartCount = computed(() => store.getters['cart/cartCount'])\n    const isAuthenticated = computed(() => store.getters['auth/isAuthenticated'])\n    \n    // 修复购物车中的图片URL问题\n    const fixCartItemImages = () => {\n      const items = cartItems.value\n      let needsUpdate = false\n      \n      items.forEach(item => {\n        if (!item.image_url) {\n          item.image_url = require('@/assets/default-product.png')\n          needsUpdate = true\n          console.log(`已修复购物车商品 \"${item.name}\" 的图片URL`)\n        }\n      })\n      \n      if (needsUpdate) {\n        localStorage.setItem('cart', JSON.stringify(items))\n        console.log('已修复并保存购物车数据')\n      }\n    }\n    \n    onMounted(() => {\n      console.log('购物车组件已加载，检查图片URL')\n      store.dispatch('cart/fetchCart')\n    })\n    \n    const handleQuantityChange = (item) => {\n      store.dispatch('cart/updateCartItem', {\n        id: item.id, // ✅ 使用 id 字段\n        quantity: item.quantity\n      })\n    }\n    \n    const handleRemove = (item) => {\n      ElMessageBox.confirm(\n        '确定要将该商品从购物车中移除吗?',\n        '提示',\n        {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }\n      ).then(() => {\n        store.dispatch('cart/removeFromCart', item.id)\n        ElMessage.success('商品已从购物车移除')\n      }).catch(() => {\n        // 取消操作\n      })\n    }\n    \n    const handleCheckout = () => {\n      if (!isAuthenticated.value) {\n        ElMessage.warning('请先登录')\n        router.push({ path: '/login', query: { redirect: '/cart' } })\n        return\n      }\n      \n      router.push('/checkout')\n    }\n    \n    const handleImageError = (item) => {\n      // 处理图片加载错误后的逻辑\n      console.error(`图片加载失败: ${item.name}`)\n    }\n    \n    return {\n      cartItems,\n      cartTotal,\n      cartCount,\n      isAuthenticated,\n      handleQuantityChange,\n      handleRemove,\n      handleCheckout,\n      getFullImageUrl,\n      handleImageError\n    }\n  }\n}\n</script>\n\n<style scoped>\n.cart-page {\n  padding: 20px 0 40px;\n}\n\n.page-header {\n  margin-bottom: 30px;\n}\n\n.page-header h1 {\n  color: #4fd58e;\n}\n\n.product-info {\n  display: flex;\n  align-items: center;\n}\n\n.product-image {\n  width: 80px;\n  height: 80px;\n  margin-right: 15px;\n  object-fit: cover;\n}\n\n.image-error-slot {\n  width: 80px;\n  height: 80px;\n  background-color: #f5f7fa;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: #909399;\n  font-size: 24px;\n}\n\n.product-details h3 {\n  margin: 0 0 5px;\n  font-size: 16px;\n  color: #303133;\n}\n\n.product-tags {\n  margin-top: 5px;\n}\n\n.product-tags .el-tag {\n  margin-right: 5px;\n}\n\n.price, .subtotal {\n  font-weight: bold;\n  color: #F56C6C;\n}\n\n.cart-actions {\n  display: flex;\n  justify-content: flex-end;\n  margin-top: 30px;\n  padding-top: 20px;\n  border-top: 1px solid #EBEEF5;\n}\n\n.cart-summary {\n  margin-right: 30px;\n}\n\n.summary-row {\n  display: flex;\n  justify-content: space-between;\n  width: 200px;\n  margin-bottom: 10px;\n  color: #606266;\n}\n\n.summary-row.total {\n  font-weight: bold;\n  color: #303133;\n  padding-top: 10px;\n  border-top: 1px dashed #EBEEF5;\n}\n\n.summary-value {\n  color: #F56C6C;\n}\n\n.action-buttons {\n  display: flex;\n  align-items: flex-end;\n}\n\n.action-buttons button {\n  margin-left: 10px;\n}\n</style> ","import { render } from \"./Cart.vue?vue&type=template&id=5cbd7e92&scoped=true\"\nimport script from \"./Cart.vue?vue&type=script&lang=js\"\nexport * from \"./Cart.vue?vue&type=script&lang=js\"\n\nimport \"./Cart.vue?vue&type=style&index=0&id=5cbd7e92&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-5cbd7e92\"]])\n\nexport default __exports__"],"names":["class","_createElementVNode","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","$setup","cartItems","length","_hoisted_4","_createVNode","_component_el_table","data","style","background","_component_el_table_column","label","default","_withCtx","_ref","row","_hoisted_5","_component_el_image","src","getFullImageUrl","image_url","alt","name","onError","$event","handleImageError","error","_hoisted_6","_component_el_icon","_component_PictureFilled","_hoisted_7","_toDisplayString","eco_certification","is_recyclable","_hoisted_8","_createBlock","_component_el_tag","size","type","align","width","_ref2","_hoisted_9","price","toFixed","_ref3","_component_el_input_number","quantity","min","max","onChange","handleQuantityChange","_ref4","_hoisted_10","_ref5","_component_el_button","onClick","handleRemove","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","cartTotal","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_cache","_ctx","$router","push","handleCheckout","disabled","isAuthenticated","cartCount","_component_el_empty","description","components","PictureFilled","setup","store","useStore","router","useRouter","computed","getters","onMounted","console","log","dispatch","item","id","ElMessageBox","confirm","confirmButtonText","cancelButtonText","then","ElMessage","success","value","warning","path","query","redirect","concat","__exports__","render"],"sourceRoot":""}