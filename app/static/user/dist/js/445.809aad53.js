"use strict";(self["webpackChunkecodeco_user_client"]=self["webpackChunkecodeco_user_client"]||[]).push([[445],{54445:(t,e,n)=>{n.r(e),n.d(e,{default:()=>A});n(44114),n(62010),n(9868);var r=n(56768),a=n(95187),u=function(t){return(0,r.Qi)("data-v-3ac8ed90"),t=t(),(0,r.jt)(),t},c={class:"cart-page"},l={class:"container"},i=u((function(){return(0,r.Lk)("div",{class:"page-header"},[(0,r.Lk)("h1",null,"我的购物车")],-1)})),o={key:0},s={class:"product-info"},d={class:"image-error-slot"},f={class:"product-details"},k={key:0,class:"product-tags"},m={class:"price"},p={class:"subtotal"},v={class:"cart-actions"},h={class:"cart-summary"},g={class:"summary-row"},y=u((function(){return(0,r.Lk)("span",null,"商品总价:",-1)})),_={class:"summary-value"},b=u((function(){return(0,r.Lk)("div",{class:"summary-row"},[(0,r.Lk)("span",null,"优惠金额:"),(0,r.Lk)("span",{class:"summary-value"},"¥0.00")],-1)})),C={class:"summary-row total"},F=u((function(){return(0,r.Lk)("span",null,"应付金额:",-1)})),L={class:"summary-value"},w={class:"action-buttons"};function W(t,e,n,u,W,E){var I=(0,r.g2)("PictureFilled"),x=(0,r.g2)("el-icon"),q=(0,r.g2)("el-image"),Q=(0,r.g2)("el-tag"),T=(0,r.g2)("el-table-column"),X=(0,r.g2)("el-input-number"),U=(0,r.g2)("el-button"),V=(0,r.g2)("el-table"),A=(0,r.g2)("el-empty");return(0,r.uX)(),(0,r.CE)("div",c,[(0,r.Lk)("div",l,[i,u.cartItems.length>0?((0,r.uX)(),(0,r.CE)("div",o,[(0,r.bF)(V,{data:u.cartItems,style:{width:"100%"},"header-cell-style":{background:"#f5f7fa"}},{default:(0,r.k6)((function(){return[(0,r.bF)(T,{label:"商品信息","min-width":"400"},{default:(0,r.k6)((function(t){var e=t.row;return[(0,r.Lk)("div",s,[(0,r.bF)(q,{src:u.getFullImageUrl(e.image_url),alt:e.name,class:"product-image",onError:function(t){return u.handleImageError(e)}},{error:(0,r.k6)((function(){return[(0,r.Lk)("div",d,[(0,r.bF)(x,null,{default:(0,r.k6)((function(){return[(0,r.bF)(I)]})),_:1})])]})),_:2},1032,["src","alt","onError"]),(0,r.Lk)("div",f,[(0,r.Lk)("h3",null,(0,a.v_)(e.name),1),e.eco_certification||e.is_recyclable?((0,r.uX)(),(0,r.CE)("div",k,[e.eco_certification?((0,r.uX)(),(0,r.Wv)(Q,{key:0,size:"small",type:"success"},{default:(0,r.k6)((function(){return[(0,r.eW)((0,a.v_)(e.eco_certification),1)]})),_:2},1024)):(0,r.Q3)("",!0),e.is_recyclable?((0,r.uX)(),(0,r.Wv)(Q,{key:1,size:"small",type:"info"},{default:(0,r.k6)((function(){return[(0,r.eW)("可回收")]})),_:1})):(0,r.Q3)("",!0)])):(0,r.Q3)("",!0)])])]})),_:1}),(0,r.bF)(T,{label:"单价",align:"center",width:"120"},{default:(0,r.k6)((function(t){var e=t.row;return[(0,r.Lk)("span",m,"¥"+(0,a.v_)(e.price.toFixed(2)),1)]})),_:1}),(0,r.bF)(T,{label:"数量",align:"center",width:"150"},{default:(0,r.k6)((function(t){var e=t.row;return[(0,r.bF)(X,{modelValue:e.quantity,"onUpdate:modelValue":function(t){return e.quantity=t},min:1,max:10,onChange:function(t){return u.handleQuantityChange(e)},size:"small"},null,8,["modelValue","onUpdate:modelValue","onChange"])]})),_:1}),(0,r.bF)(T,{label:"小计",align:"center",width:"120"},{default:(0,r.k6)((function(t){var e=t.row;return[(0,r.Lk)("span",p,"¥"+(0,a.v_)((e.price*e.quantity).toFixed(2)),1)]})),_:1}),(0,r.bF)(T,{label:"操作",align:"center",width:"80"},{default:(0,r.k6)((function(t){var e=t.row;return[(0,r.bF)(U,{type:"text",onClick:function(t){return u.handleRemove(e)},style:{color:"#F56C6C"}},{default:(0,r.k6)((function(){return[(0,r.eW)(" 删除 ")]})),_:2},1032,["onClick"])]})),_:1})]})),_:1},8,["data"]),(0,r.Lk)("div",v,[(0,r.Lk)("div",h,[(0,r.Lk)("div",g,[y,(0,r.Lk)("span",_,"¥"+(0,a.v_)(u.cartTotal.toFixed(2)),1)]),b,(0,r.Lk)("div",C,[F,(0,r.Lk)("span",L,"¥"+(0,a.v_)(u.cartTotal.toFixed(2)),1)])]),(0,r.Lk)("div",w,[(0,r.bF)(U,{onClick:e[0]||(e[0]=function(e){return t.$router.push("/products")})},{default:(0,r.k6)((function(){return[(0,r.eW)("继续购物")]})),_:1}),(0,r.bF)(U,{type:"primary",onClick:u.handleCheckout,disabled:!u.isAuthenticated},{default:(0,r.k6)((function(){return[(0,r.eW)(" 结算 ("+(0,a.v_)(u.cartCount)+" 件) ",1)]})),_:1},8,["onClick","disabled"])])])])):((0,r.uX)(),(0,r.Wv)(A,{key:1,description:"您的购物车是空的"},{default:(0,r.k6)((function(){return[(0,r.bF)(U,{type:"primary",onClick:e[1]||(e[1]=function(e){return t.$router.push("/products")})},{default:(0,r.k6)((function(){return[(0,r.eW)("去购物")]})),_:1})]})),_:1}))])])}n(51629),n(60739),n(18111),n(7588),n(33110),n(26099),n(23500);var E=n(60782),I=n(50973),x=n(91036),q=n(51219),Q=n(61981),T=n(57477);const X={name:"Cart",components:{PictureFilled:T.PictureFilled},setup:function(){var t=(0,E.Pj)(),e=(0,I.rd)(),n=(0,r.EW)((function(){return t.getters["cart/cartItems"]})),a=(0,r.EW)((function(){return t.getters["cart/cartTotal"]})),u=(0,r.EW)((function(){return t.getters["cart/cartCount"]})),c=(0,r.EW)((function(){return t.getters["auth/isAuthenticated"]}));(0,r.sV)((function(){console.log("购物车组件已加载，检查图片URL"),t.dispatch("cart/fetchCart")}));var l=function(e){t.dispatch("cart/updateCartItem",{id:e.id,quantity:e.quantity})},i=function(e){x.s.confirm("确定要将该商品从购物车中移除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.dispatch("cart/removeFromCart",e.id),q.nk.success("商品已从购物车移除")}))["catch"]((function(){}))},o=function(){if(!c.value)return q.nk.warning("请先登录"),void e.push({path:"/login",query:{redirect:"/cart"}});e.push("/checkout")},s=function(t){console.error("图片加载失败: ".concat(t.name))};return{cartItems:n,cartTotal:a,cartCount:u,isAuthenticated:c,handleQuantityChange:l,handleRemove:i,handleCheckout:o,getFullImageUrl:Q.m,handleImageError:s}}};var U=n(71241);const V=(0,U.A)(X,[["render",W],["__scopeId","data-v-3ac8ed90"]]),A=V}}]);
//# sourceMappingURL=445.809aad53.js.map